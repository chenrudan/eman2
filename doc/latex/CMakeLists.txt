SET(DOC_PATH ${CMAKE_INSTALL_PREFIX}/doc)

FILE(GLOB_RECURSE MKDOCSRCS
	${EMAN_SOURCE_DIR}/doc/latex/*.tex
)

ADD_CUSTOM_TARGET( mkdoc ALL
	DEPENDS	${MKDOCSRCS}
)

ADD_CUSTOM_COMMAND(
	SOURCE  mkdoc
	COMMAND cp 
	ARGS -f ${EMAN_SOURCE_DIR}/doc/latex/*.tex .
	TARGET mkdoc
)

ADD_CUSTOM_COMMAND(
	SOURCE  mkdoc
#	OUTPUT	EMAN2.dvi
	COMMAND latex 		ARGS EMAN2
	COMMAND makeindex	ARGS EMAN2.idx
	COMMAND latex		ARGS EMAN2
	COMMAND makeindex	ARGS EMAN2.idx
	COMMAND latex		ARGS EMAN2	
	TARGET mkdoc
#	DEPENDS	mkdoc	
)

ADD_CUSTOM_COMMAND(
	SOURCE  mkdoc
#	OUTPUT	EMAN2.ps
	COMMAND dvips  		ARGS -o EMAN2.ps EMAN2.dvi
	TARGET mkdoc
#	DEPENDS	EMAN2.dvi
)

ADD_CUSTOM_COMMAND(
	SOURCE  mkdoc
#	OUTPUT	EMAN2.pdf 
	COMMAND ps2pdf  	ARGS EMAN2.ps EMAN2.pdf
	TARGET mkdoc
#	DEPENDS	EMAN2.ps
)

ADD_CUSTOM_COMMAND(
	SOURCE  mkdoc
	COMMAND latex2html  
	ARGS EMAN2.tex
	TARGET mkdoc
)

ADD_CUSTOM_COMMAND(
	SOURCE mkdoc
	COMMAND cp
	ARGS -f EMAN2.dvi EMAN2.ps EMAN2.pdf ${DOC_PATH}
	TARGET mkdoc
)

ADD_CUSTOM_COMMAND(
	SOURCE mkdoc
	COMMAND mkdir 
	ARGS -p ${DOC_PATH}/EMAN2.html
	TARGET mkdoc
)

ADD_CUSTOM_COMMAND(
	SOURCE mkdoc
	COMMAND cp
	ARGS -f EMAN2/* ${DOC_PATH}/EMAN2.html
	TARGET mkdoc
)

